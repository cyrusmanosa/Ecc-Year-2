CREATE TABLE "fixinformation" (
  "user_id" INT GENERATED BY DEFAULT AS IDENTITY UNIQUE PRIMARY KEY,
  "first_name" VARCHAR NOT NULL,
  "last_name" VARCHAR NOT NULL,
  "email" VARCHAR UNIQUE NOT NULL,
  "hashed_password" VARCHAR,
  "birth" VARCHAR NOT NULL,
  "country" VARCHAR NOT NULL,
  "gender" VARCHAR NOT NULL,
  "blood" VARCHAR NOT NULL,
  "age" INT NOT NULL,
  "constellation" VARCHAR NOT NULL,
  "certification" BOOLEAN DEFAULT FALSE,
  "created_at" TIMESTAMPTZ NOT NULL DEFAULT (NOW()),
  "password_changed_at" TIMESTAMPTZ
);

CREATE TABLE "canchangeinformation" (
  "user_id" INT PRIMARY KEY,
  "nickname" VARCHAR,
  "city" VARCHAR,
  "sexual" VARCHAR,
  "height" INT,
  "weight" INT,
  "speaklanguage" VARCHAR[],
  "education" VARCHAR,
  "job" VARCHAR,
  "annual_salary" INT,
  "sociability" VARCHAR,
  "hobby_type" VARCHAR,
  "experience" INT,
  "accompany_type" VARCHAR,
  "religious" VARCHAR,
  "introduce" VARCHAR,
  "info_changed_at" TIMESTAMPTZ NOT NULL DEFAULT (NOW())
);

CREATE TABLE "lover" (
  "user_id" INT PRIMARY KEY,
  "min_age" INT,
  "max_age" INT,
  "city" VARCHAR[],
  "gender" VARCHAR,
  "sexual" VARCHAR,
  "speaklanguage" VARCHAR[],
  "info_changed_at" TIMESTAMPTZ NOT NULL DEFAULT (NOW())
);

CREATE TABLE "hobby" (
  "user_id" INT PRIMARY KEY,
  "era" INT,
  "city" VARCHAR[],
  "gender" VARCHAR,
  "speaklanguage" VARCHAR[],
  "find_type" VARCHAR,
  "experience" INT,
  "info_changed_at" TIMESTAMPTZ NOT NULL DEFAULT (NOW())
);

CREATE TABLE "accompany" (
  "user_id" INT PRIMARY KEY,
  "era" INT,
  "speaklanguage" VARCHAR[],
  "find_type" VARCHAR,
  "sociability" VARCHAR,
  "info_changed_at" TIMESTAMPTZ NOT NULL DEFAULT (NOW())
);

CREATE TABLE image (
  "user_id" INT PRIMARY KEY,
  "img1" BYTEA NOT NULL,
  "img2" BYTEA,
  "img3" BYTEA,
  "img4" BYTEA,
  "img5" BYTEA
);


CREATE TABLE "targetlist" (
  "user_id" INT PRIMARY KEY,
  "target_1_id" INT NOT NULL,
  "t1_Type" VARCHAR NOT NULL,
  "target_2_id" INT,
  "t2_Type" VARCHAR,
  "target_3_id" INT,
  "t3_Type" VARCHAR,
  "updated_at" TIMESTAMPTZ NOT NULL DEFAULT (NOW())
);

CREATE TABLE "changetargetuser" (
  "user_id" INT NOT NULL,
  "change_user_id" INT NOT NULL,
  "reason" VARCHAR NOT NULL,
  "frequency" INT NOT NULL,
  "change_time" TIMESTAMPTZ NOT NULL DEFAULT NOW()
);

CREATE TABLE "contact" (
  "contact_id" INT GENERATED BY DEFAULT AS IDENTITY UNIQUE PRIMARY KEY,
  "user_id" INT NOT NULL,
  "contact_type" VARCHAR NOT NULL,
  "message" VARCHAR NOT NULL,
  "status" VARCHAR DEFAULT 'active',
  "contact_at" TIMESTAMPTZ NOT NULL DEFAULT (NOW())
);




ALTER TABLE "canchangeinformation" ADD FOREIGN KEY ("user_id") REFERENCES "fixinformation" ("user_id");

ALTER TABLE "lover" ADD FOREIGN KEY ("user_id") REFERENCES "fixinformation" ("user_id");

ALTER TABLE "hobby" ADD FOREIGN KEY ("user_id") REFERENCES "fixinformation" ("user_id");

ALTER TABLE "accompany" ADD FOREIGN KEY ("user_id") REFERENCES "fixinformation" ("user_id");

ALTER TABLE "image" ADD FOREIGN KEY ("user_id") REFERENCES "fixinformation" ("user_id");

ALTER TABLE "targetlist" ADD FOREIGN KEY ("user_id") REFERENCES "fixinformation" ("user_id");

ALTER TABLE "changetargetuser" ADD FOREIGN KEY ("user_id") REFERENCES "fixinformation" ("user_id");

ALTER TABLE "contact" ADD FOREIGN KEY ("user_id") REFERENCES "fixinformation" ("user_id");